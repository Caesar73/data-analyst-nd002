dyHighlight(highlightCircleSize = 4,
highlightSeriesBackgroundAlpha = 0.5,
hideOnMouseOut = FALSE)
list_v2 <- c("gold", "platinum", "palladium", "silver100")
prices_xts <- (centrobank_xts[,list_v2])
dygraph(prices_xts, main = "Exchange Rates" ) %>%
dyOptions(colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
dyHighlight(highlightCircleSize = 4,
highlightSeriesBackgroundAlpha = 0.5,
hideOnMouseOut = FALSE)
# Chunk 1: global_options
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
# Chunk 2: Working_Directory
setwd('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4')
p='/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/'
# Chunk 3: Libraries_1
library(devtools)
library(knitr)
library(markdown)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(gridExtra)
library(scales)
library(reshape2)
library(plyr)
library(GGally)
library(dplyr)
library(tidyr)
library(xlsx)
library(lubridate)
# Chunk 4: Libraries_2
library(corrplot)
library(PerformanceAnalytics)
library(plotly)
library(RCurl)
library(bitops)
library(memisc)
library(dygraphs)
library(xts)
# Chunk 5
centrobank <- data.frame(read.xlsx("c_bank.xlsx",sheetName="Data",header=TRUE))
head(centrobank,3)
# Chunk 6
row.with.na <- apply(centrobank, 1, function(x){any(is.na(x))})
s <- sum(row.with.na)
cat('sum(row.with.na) = ', s)
# Chunk 7
str(centrobank)
# Chunk 8
summary(centrobank)
# Chunk 9
centrobank$temp1 <- gsub(" ","", centrobank$foreign_exchange_reserves)
centrobank$foreign_exchange_reserves <- as.numeric(centrobank$temp1)
centrobank$temp2 <- gsub(" ","", centrobank$monetary_gold)
centrobank$monetary_gold <- as.numeric(centrobank$temp2)
summary(centrobank$foreign_exchange_reserves)
summary(centrobank$monetary_gold)
# Chunk 10
drops <- c("temp1","temp2")
centrobank <- centrobank[ , !(names(centrobank) %in% drops)]
# Chunk 11
centrobank$day= as.numeric(format(centrobank$date, "%d"))
centrobank$month = format(centrobank$date, "%B")
centrobank$year = as.numeric(format(centrobank$date, "%Y"))
str(centrobank)
# Chunk 12
p0 <- ggplot(aes(x = dual_currency_basket), data = centrobank) +
geom_histogram(binwidth = 1, color = 'purple', aes(fill = ..count..)) +
scale_x_continuous(name = 'dual currency basket, rubles',
limits=c(32, 88), breaks=seq(32, 88, 2)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() +
theme(axis.text.x=
element_text(size=8,angle=85),axis.title=element_text(size=12))
p0
# Chunk 13: Univariate_Plots_1
p1 <- ggplot(aes(x = gold), data = centrobank) +
geom_histogram(binwidth = 50, color = 'purple', aes(fill = ..count..)) +
scale_x_continuous(name = 'gold, rubles per gram',
limits=c(1200, 3200), breaks=seq(1200, 3200, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() +
theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 14: Univariate_Plots_2
p2 <- ggplot(aes(x = silver), data = centrobank) +
geom_histogram(binwidth = 0.5, color ='darkblue', aes(fill = ..count..)) +
scale_x_continuous(name = 'silver, rubles per gram',
limits = c(19, 44), breaks = seq(19, 44, 0.5)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() +
theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 15: Univariate_Plots_3
p3 <- ggplot(aes(x = platinum), data = centrobank) +
geom_histogram(binwidth = 50, color = 'darkmagenta', aes(fill = ..count..)) +
scale_x_continuous(name = 'platinum, rubles per gram',
limits = c(1200, 2800), breaks=seq(1200, 2800, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 16: Univariate_Plots_4
p4 <- ggplot(aes(x = palladium), data = centrobank) +
geom_histogram(binwidth = 30, color = 'blue', aes(fill = ..count..)) +
scale_x_continuous(name = 'palladium, rubles per gram',
limits = c(550, 1750), breaks=seq(550, 1750, 30)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 17
g101 <- grid.arrange(p1, p2, p3, p4, ncol = 2)
path01=paste(p, 'Univariate_Plots_5_1.png', sep = '')
ggsave(path01, g101, width = 18, height = 24)
# Chunk 18: Univariate_Plots_6
p101 <- ggplot(aes(x = EUR_978), data = centrobank) +
geom_histogram(binwidth = 1, color = 'navy', aes(fill = ..count..)) +
scale_x_continuous(name = 'EUR, rubles',
limits=c(38, 92), breaks=seq(38, 92, 2)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 19: Univariate_Plots_7
p102 <- ggplot(aes(x = USD_840), data = centrobank) +
geom_histogram(binwidth = 1, color ='darkblue', aes(fill = ..count..)) +
scale_x_continuous(name = 'USD, rubles',
limits = c(28, 84), breaks = seq(28, 84, 2)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 20: Univariate_Plots_8
p103 <- ggplot(aes(x =foreign_exchange_reserves), data = centrobank) +
geom_histogram(binwidth = 5000, color = 'darkmagenta', aes(fill = ..count..))+
scale_x_continuous(name = 'foreign exchange reserves, mln. USD',
limits =c(305000, 490000),breaks=seq(305000,490000,10000))+
scale_fill_gradientn(colours=cm.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 21: Univariate_Plots_9
p104 <- ggplot(aes(x = monetary_gold), data = centrobank) +
geom_histogram(binwidth = 500, color = 'blue', aes(fill = ..count..)) +
scale_x_continuous(name = 'monetary gold, mln.USD',
limits = c(38500, 63500), breaks=seq(38500, 63500, 1000)) +
scale_fill_gradientn(colours=cm.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 22
g102 <- grid.arrange(p101, p102, p103, p104, ncol = 2)
path02=paste(p, 'Univariate_Plots_10_1.png', sep = '')
ggsave(path02, g102, width = 18, height = 24)
# Chunk 23: Univariate_Plots_11
p105 <- ggplot(aes(x = BRL_986), data = centrobank) +
geom_histogram(binwidth = 0.25, color = 'navy', aes(fill = ..count..)) +
scale_x_continuous(name = 'BRL, rubles',
limits=c(13, 27), breaks=seq(13, 27, 0.5)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 24: Univariate_Plots_12
p106 <- ggplot(aes(x = JPY_392), data = centrobank) +
geom_histogram(binwidth = 0.01, color ='darkblue', aes(fill = ..count..)) +
scale_x_continuous(name = 'JPY, rubles',
limits = c(0.3, 0.72), breaks = seq(0.3, 0.72, 0.02)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 25: Univariate_Plots_13
p107 <- ggplot(aes(x =CNY_156), data = centrobank) +
geom_histogram(binwidth = 0.2, color='darkmagenta', aes(fill = ..count..)) +
scale_x_continuous(name = 'CNY, rubles', limits = c(4.4, 12.8),
breaks=seq(4.4,12.8, 0.4)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 26: Univariate_Plots_14
p108 <- ggplot(aes(x = INR_356), data = centrobank) +
geom_histogram(binwidth = 0.02, color = 'blue', aes(fill = ..count..)) +
scale_x_continuous(name = 'INR, rubles', limits = c(0.45, 1.25),
breaks=seq(0.45, 1.25, 0.04)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),
axis.title=element_text(size=12))
# Chunk 27
g103 <- grid.arrange(p105, p106, p107, p108, ncol = 2)
path03=paste(p, 'Univariate_Plots_15_1.png', sep = '')
ggsave(path03, g103, width = 18, height = 24)
# Chunk 28: Univariate_Plots_16
p112 <- ggplot(centrobank, aes( x = 1, y = EUR_978)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'orange') +
stat_summary(fun.y=mean, colour="darkred", geom="point",
shape=8, size=3)
p113 <- ggplot(centrobank, aes( x = 2, y = USD_840)) + geom_boxplot() +
geom_jitter(alpha=0.4, size= 1, color = 'orange') +
stat_summary(fun.y=mean, colour="darkred", geom="point",
shape=8, size=3)
p114 <- ggplot(centrobank, aes( x = 3, y = JPY_392)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'brown') +
stat_summary(fun.y=mean, colour="black", geom="point",
shape=8, size=3)
p115 <- ggplot(centrobank, aes( x = 4, y = CNY_156)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'brown') +
stat_summary(fun.y=mean, colour="black", geom="point",
shape=8, size=3)
p116 <- ggplot(centrobank, aes( x = 5, y = INR_356)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'brown') +
stat_summary(fun.y=mean, colour="black", geom="point",
shape=8, size=3)
p117 <- ggplot(centrobank, aes( x = 6, y = BRL_986)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'purple') +
stat_summary(fun.y=mean, colour="black", geom="point",
shape=8, size=3)
p120 <- ggplot(centrobank, aes( x = 9, y = gold)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'blue') +
stat_summary(fun.y=mean, colour="darkblue", geom="point",
shape=8, size=3)
p121 <- ggplot(centrobank, aes( x = 10, y = silver)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'blue') +
stat_summary(fun.y=mean, colour="darkblue", geom="point",
shape=8, size=3)
p122 <- ggplot(centrobank, aes( x = 11, y = platinum)) + geom_boxplot() +
geom_jitter(alpha=0.4, size = 1, color = 'blue') +
stat_summary(fun.y=mean, colour="darkblue", geom="point",
shape=8, size=3)
p123 <- ggplot(centrobank, aes( x = 12, y = palladium)) + geom_boxplot() +
geom_jitter(alpha=0.4, color = 'blue') +
stat_summary(fun.y=mean, colour="darkblue", geom="point",
shape=8, size=3)
p118 <- ggplot(centrobank, aes( x = 7, y = foreign_exchange_reserves)) +
geom_boxplot() +  geom_jitter(alpha=0.4, color = 'red') +
stat_summary(fun.y=mean, colour="brown", geom="point",
shape=8, size=3)
p119 <- ggplot(centrobank, aes( x = 8, y = monetary_gold)) + geom_boxplot() +
geom_jitter(alpha=0.4, color = 'green') +
stat_summary(fun.y=mean, colour="darkgreen", geom="point",
shape=8, size=3)
# Chunk 29
g104<- grid.arrange(p112, p113, p114, p115, p116, p117,
p118, p119, p120, p121, p122, p123, ncol = 4)
path06=paste(p, 'Univariate_Plots_17_1.png', sep = '')
ggsave(path06, g104, width = 12, height = 24)
# Chunk 30
include <- c("dual_currency_basket", "EUR_978", "USD_840", "JPY_392", "CNY_156",
"BRL_986", "INR_356", "gold", "silver", "platinum", "palladium",
"foreign_exchange_reserves", "monetary_gold")
corr_centrobank <- (centrobank[,include])
str(corr_centrobank)
# Chunk 31
chart.Correlation(corr_centrobank, histogram=TRUE, pch=19)
# Chunk 32
mcorr_centrobank <- cor(corr_centrobank)
corrplot.mixed(mcorr_centrobank, lower="number", upper="pie",
order ="AOE", tl.col="darkblue", tl.cex=0.5)
# Chunk 33: Bivariate_Plots_1
p5 <- ggplot(centrobank,
aes(x = date, y = BRL_986,
color = format(as.Date(date, format='%d/%m/%Y'), "%Y"))) +
geom_point(size = 2, shape = 5) +
geom_smooth(method = "lm", se = FALSE, size=1)+
scale_colour_brewer(palette='Set1') + theme_bw()+
guides(color=guide_legend(title="year", direction = "horizontal"))
# Chunk 34: Bivariate_Plots_2
p6 <- ggplot(centrobank,
aes(x = date, y = JPY_392,
color = format(as.Date(date, format='%d/%m/%Y'), "%Y"))) +
geom_point(size = 2, shape = 5) +
geom_smooth(method = "lm", se = FALSE, size=1)+
scale_colour_brewer(palette='Spectral') + theme_bw()
# Chunk 35: Bivariate_Plots_3
p7 <- ggplot(centrobank,
aes(x = date, y = CNY_156,
color = format(as.Date(date, format='%d/%m/%Y'), "%Y"))) +
geom_point(size = 2, shape = 5) +
geom_smooth(method = "lm", se = FALSE, size=1)+
scale_colour_brewer(palette='Spectral') + theme_bw()
# Chunk 36: Bivariate_Plots_4
p8 <- ggplot(centrobank,
aes(x = date, y = INR_356,
color = format(as.Date(date, format='%d/%m/%Y'), "%Y"))) +
geom_point(size = 2, shape = 5) +
geom_smooth(method = "lm", se = FALSE, size=1)+
scale_colour_brewer(palette='Spectral') + theme_bw()
# Chunk 37
get_legend <- function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
legend_g2 <- get_legend(p5)
g2 <- grid.arrange(arrangeGrob(p5 + theme(legend.position="none"),
p6 + theme(legend.position="none"),
p7 + theme(legend.position="none"),
p8 + theme(legend.position="none"),
ncol=2),
legend_g2,
ncol=1, heights=c(19, 1))
path04=paste(p, 'Bivariate_Plots_5_1.png', sep = '')
ggsave(path04, g2, width = 24, height = 18)
# Chunk 38: Bivariate_Plots_6
p9 <- ggplot(centrobank, aes(x = date, y=foreign_exchange_reserves, color = foreign_exchange_reserves)) + geom_jitter(size = 2, alpha=0.3, shape = 6) +
scale_colour_gradientn(colours=rainbow(10)) +
geom_smooth(aes(y=foreign_exchange_reserves), color = '#FF6633') +
theme_bw() + ylab('foreign exchange reserves, millions of US dollars')
# Chunk 39: Bivariate_Plots_7
p10 <- ggplot(centrobank, aes(x=date,y=monetary_gold,color = monetary_gold)) +
geom_jitter(size = 2, alpha=0.3, shape = 6) +
scale_colour_gradientn(colours=rainbow(10)) +
geom_smooth(aes(y=monetary_gold), color = '#00FFFF') + theme_bw() +
ylab('monetary gold reserves, millions of US dollars')
# Chunk 40
g3 <- grid.arrange(p9, p10, ncol = 1)
path05=paste(p, 'Bivariate_Plots_8_1.png', sep = '')
ggsave(path05, g3, width = 12, height = 24)
# Chunk 41: Bivariate_Plots_9
p11 <- ggplot(centrobank, aes(x=dual_currency_basket, y=gold, color = gold)) +
geom_point() + geom_smooth(color = 'darkred') +
scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 42: Bivariate_Plots_10
p12 <- ggplot(centrobank, aes(x=dual_currency_basket,y=silver,color = silver)) +
geom_point() + geom_smooth(color = 'darkgreen') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 43: Bivariate_Plots_11
p13 <- ggplot(centrobank, aes (x=dual_currency_basket, y=platinum,
color = platinum)) + geom_point() +
geom_smooth(color='darkred') +
scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 44: Bivariate_Plots_12
p14 <- ggplot(centrobank, aes (x=dual_currency_basket, y=palladium,
color = palladium)) +
geom_point() + geom_smooth(color = 'darkgreen') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 45
g4 <- grid.arrange(p11, p12, p13, p14, ncol = 2)
path07=paste(p, 'Bivariate_Plots_13_1.png', sep = '')
ggsave(path07, g4, width = 18, height = 24)
# Chunk 46: Bivariate_Plots_14
p15 <- ggplot(centrobank, aes(x=dual_currency_basket,y=JPY_392,color=JPY_392)) +
geom_point() + geom_smooth(color = 'darkred') +
scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 47: Bivariate_Plots_15
p16 <- ggplot(centrobank,aes(x=dual_currency_basket,y=CNY_156,color = CNY_156))+
geom_point() + geom_smooth(color = 'darkred') +
scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 48: Bivariate_Plots_16
p17 <- ggplot(centrobank,aes(x=dual_currency_basket,y=INR_356,color=INR_356)) +
geom_point() + geom_smooth(color='darkred')+
scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 49: Bivariate_Plots_17
p18 <- ggplot(centrobank, aes (x=JPY_392, y=CNY_156, color = CNY_156)) +
geom_point() + geom_smooth(color = 'darkgreen') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 50: Bivariate_Plots_18
p19 <- ggplot(centrobank, aes (x=CNY_156, y=INR_356, color = INR_356)) +
geom_point() + geom_smooth(color = 'darkgreen') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 51: Bivariate_Plots_19
p20 <- ggplot(centrobank, aes (x=JPY_392, y=INR_356, color = INR_356)) +
geom_point() + geom_smooth(color = 'darkgreen') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 52
g5 <- grid.arrange(p15, p16, p17, p18, p19, p20, ncol = 3)
path08=paste(p, 'Bivariate_Plots_20_1.png', sep = '')
ggsave(path08, g5, width = 18, height = 24)
# Chunk 53: Bivariate_Plots_21
p21 <- ggplot(centrobank, aes (x=foreign_exchange_reserves,
y=monetary_gold, color = monetary_gold)) +
geom_jitter(shape = 13, size = 4) + geom_smooth(color = '#00FF99') +
scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
p21
path09=paste(p, 'Bivariate_Plots_21_1.png', sep = '')
ggsave(path09, p21, width = 12, height = 8)
# Chunk 54
with(centrobank, cor.test(dual_currency_basket, gold))
with(centrobank, cor.test(dual_currency_basket, silver))
with(centrobank, cor.test(dual_currency_basket, platinum))
with(centrobank, cor.test(dual_currency_basket, palladium))
# Chunk 55
with(centrobank, cor.test(dual_currency_basket, JPY_392))
with(centrobank, cor.test(dual_currency_basket, CNY_156))
with(centrobank, cor.test(dual_currency_basket, INR_356))
with(centrobank, cor.test(JPY_392, CNY_156))
with(centrobank, cor.test(JPY_392, INR_356))
with(centrobank, cor.test(INR_356, CNY_156))
# Chunk 56
with(centrobank, cor.test(foreign_exchange_reserves, monetary_gold))
# Chunk 57
p24 <- ggplot(centrobank, aes(x=dual_currency_basket, y = gold, color = year))+
geom_point(shape=10, alpha=0.5, size = 2) +
facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() +
scale_colour_gradientn(colours=heat.colors(5)) + theme_bw() +
ggtitle('Gold prices and dual currency basket in 2012-2016, rubles')
p24
path10=paste(p, 'Multivariate_Plots_1_1.png', sep = '')
ggsave(path10, p24, width = 18, height = 12)
# Chunk 58
pl1 <- plot_ly(centrobank, x=JPY_392, y=CNY_156,
z=INR_356, color = gold,
text = paste(date, "gold price: ", gold),
colors = 'Spectral', type="scatter3d", mode="markers",
marker = list(size = 8, symbol = "circle-open"))
pl2 <- layout(pl1, title = "Prices for Gold and Rates for JPY, CNY, INR",
scene = list(
xaxis = list(title = "JPY 392"),
yaxis = list(title = "CNY 156"),
zaxis = list(title = "INR_356")))
pl2
# Chunk 59
pl3 <- plot_ly(centrobank, x=gold, y=silver, z=platinum,
color = dual_currency_basket,
text = paste(date,
"dual currency basket: ", dual_currency_basket),
colors = 'Spectral', type="scatter3d", mode="markers",
marker = list(size = 8, symbol = "diamond-open"))
pl4 <- layout(pl3, title = "Prices for Gold, Silver,
Platinum and Dual Currency Basket",
scene = list(
xaxis = list(title = "gold"),
yaxis = list(title = "silver"),
zaxis = list(title = "platinum")))
pl4
# Chunk 60: Multivariate_Plots_4
centrobank_y <- aggregate(corr_centrobank, list(centrobank$year), mean)
centrobank_y$silver100 <- 100*centrobank_y$silver
# Chunk 61
t1='Year Means of Prices for Precious Metals/Year means of Dual Currency Basket'
x1 = 'year'
y1 = 'mean of prices for precious metals/mean of dual currency basket'
p130 <- plot_ly(centrobank_y, x=c(2012,2013,2014,2015,2016),
y =gold/dual_currency_basket,
name = "gold / dual currancy basket", type = "bar")
p131 <- add_trace(centrobank_y, x=c(2012,2013,2014,2015,2016),
y=silver100/dual_currency_basket,
name = "silver100 / dual currancy basket", type = "bar")
p132 <- add_trace(centrobank_y, x=c(2012,2013,2014,2015,2016),
y=palladium/dual_currency_basket,
name = "palladium / dual currency basket", type = "bar")
p133 <- add_trace(centrobank_y, x=c(2012,2013,2014,2015,2016),
y=platinum/dual_currency_basket,
name = "platinum / dual currency basket", type = "bar")
pl5 <- layout(p133, title = t1,
xaxis = list(title = x1, showgrid = F),
yaxis = list(title = y1, showgrid = F))
pl5
# Chunk 62: Data_Series_1
centrobank$USD50 <- 50*centrobank$USD_840
centrobank$EUR50 <- 50*centrobank$EUR_978
centrobank$CNY300 <- 300*centrobank$CNY_156
centrobank$JPY4000 <- 4000*centrobank$JPY_392
centrobank$BRL100 <- 100*centrobank$BRL_986
centrobank$INR3000 <- 3000*centrobank$INR_356
centrobank$silver100 <- 100*centrobank$silver
# Chunk 63: Data_Series_2
centrobank_xts <- xts(centrobank[, -1], centrobank[, 1])
# Chunk 64: Data_Series_3
list_v1 <- c("EUR50", "USD50", "CNY300", "JPY4000", "BRL100", "INR3000")
rates_xts <- (centrobank_xts[,list_v1])
# Chunk 65
dygraph(rates_xts, main = "Exchange Rates" ) %>%
dyOptions(colors = RColorBrewer::brewer.pal(6, "Set2")) %>%
dyHighlight(highlightCircleSize = 4,
highlightSeriesBackgroundAlpha = 0.5,
hideOnMouseOut = FALSE)
# Chunk 66: Data_Series_4
list_v2 <- c("gold", "platinum", "palladium", "silver100")
prices_xts <- (centrobank_xts[,list_v2])
# Chunk 67
dygraph(prices_xts, main = "Prices for Precious Metals" ) %>%
dyOptions(colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
dyHighlight(highlightCircleSize = 4,
highlightSeriesBackgroundAlpha = 0.5,
hideOnMouseOut = FALSE)
# Chunk 68
m1 <- lm(gold ~ dual_currency_basket, data = centrobank)
m2 <- update(m1, ~ . + platinum)
m3 <- update(m2, ~ . + palladium)
m4 <- update(m3, ~ . + silver)
mtable(m1, m2, m3, m4)
# Chunk 69
p_final1 <- layout(p133, title = t1, barmode = 'stack',
xaxis = list(title = x1, showgrid = F),
yaxis = list(title = y1, showgrid = F))
p_final1
# Chunk 70: Plot_Two_1
list_vf <- c("EUR50", "USD50", "CNY300", "gold", "platinum")
data_xts <- (centrobank_xts[,list_vf])
# Chunk 71
dygraph(data_xts, main = "Prices for Precious Metals and Exchange Rates" ) %>%
dyOptions(colors = RColorBrewer::brewer.pal(5, "Set1")) %>%
dyHighlight(highlightCircleSize = 4,
highlightSeriesBackgroundAlpha = 0.5,
hideOnMouseOut = FALSE)
# Chunk 72: Plot_Three_1
p25 <- ggplot(centrobank,
aes(x=dual_currency_basket,
y = (gold+silver+platinum+palladium)/4, color = year)) +
geom_point(shape=7, alpha=0.5, size = 2) + geom_smooth() +
scale_colour_gradientn(colours=rainbow(5)) +
ggtitle('Mean of prices for precious metals and dual currency basket,
rubles') + theme_bw()
# Chunk 73: Plot_Three_2
p26 <- ggplot(centrobank,
aes(x=dual_currency_basket,
y = (gold+silver+platinum+palladium)/4, color = year)) +
geom_point(shape=7, alpha=0.5, size = 2) +
facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() +
scale_colour_gradientn(colours=rainbow(5)) +
ggtitle('Mean of prices for precious metals and dual currency basket,
rubles') + theme_bw()
# Chunk 74
p_final3 <- grid.arrange(p25, p26, ncol=1)
path12=paste(p, 'Plot_Three_3_1.png', sep = '')
ggsave(path12, p_final3, width = 18, height = 24)
