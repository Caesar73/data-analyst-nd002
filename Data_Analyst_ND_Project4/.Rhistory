library(lubridate)
# Chunk 4
library(corrplot)
library(PerformanceAnalytics)
library(plotly)
library(RCurl)
library(bitops)
library(memisc)
# Chunk 5
centrobank <- data.frame(read.xlsx("c_bank.xlsx", sheetName="Data", header=TRUE))
head(centrobank)
# Chunk 6
row.with.na <- apply(centrobank, 1, function(x){any(is.na(x))})
s <- sum(row.with.na)
cat('sum(row.with.na) = ', s)
# Chunk 7
str(centrobank)
# Chunk 8
summary(centrobank)
# Chunk 9
centrobank$temp1 <- gsub(" ","", centrobank$foreign_exchange_reserves)
centrobank$foreign_exchange_reserves <- as.numeric(centrobank$temp1)
centrobank$temp2 <- gsub(" ","", centrobank$monetary_gold)
centrobank$monetary_gold <- as.numeric(centrobank$temp2)
summary(centrobank$foreign_exchange_reserves)
summary(centrobank$monetary_gold)
# Chunk 10
drops <- c("temp1","temp2")
centrobank <- centrobank[ , !(names(centrobank) %in% drops)]
# Chunk 11
centrobank$day= as.numeric(format(centrobank$date, "%d"))
centrobank$month = format(centrobank$date, "%B")
centrobank$year = as.numeric(format(centrobank$date, "%Y"))
str(centrobank)
# Chunk 12
p1 <- ggplot(aes(x = gold), data = centrobank) +
geom_histogram(binwidth = 50, color = 'purple', aes(fill = ..count..)) +
scale_x_continuous(name = 'gold, rubles per gram',
limits=c(1200, 3200), breaks=seq(1200, 3200, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 13
p2 <- ggplot(aes(x = silver), data = centrobank) +
geom_histogram(binwidth = 0.5, color ='darkblue', aes(fill = ..count..)) +
scale_x_continuous(name = 'silver, rubles per gram',
limits = c(19, 44), breaks = seq(19, 44, 0.5)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 14
p3 <- ggplot(aes(x = platinum), data = centrobank) +
geom_histogram(binwidth = 50, color = 'darkmagenta', aes(fill = ..count..)) +
scale_x_continuous(name = 'platinum, rubles per gram', limits = c(1200, 2800), breaks=seq(1200, 2800, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 15
p4 <- ggplot(aes(x = palladium), data = centrobank) +
geom_histogram(binwidth = 30, color = 'blue', aes(fill = ..count..)) +
scale_x_continuous(name = 'palladium, rubles per gram', limits = c(550, 1750), breaks=seq(550, 1750, 30)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 16
g1 <- grid.arrange(p1, p2, p3, p4, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_5_1.png', g1, width = 18, height = 24)
# Chunk 17
data_length = length(centrobank$BRL_986)
x = seq(1, data_length)
p5 <- ggplot(centrobank) + geom_point(aes(x = x, y = BRL_986, color = x), size = 2, shape = 5) + scale_colour_gradient2_tableau('Red-Blue') + theme_bw()
# Chunk 18
p6 <- ggplot(centrobank) + geom_point(aes(x = x, y = JPY_392, color = x), size = 2, shape = 12) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 19
p7 <-ggplot(centrobank) + geom_point(aes(x = x, y = CNY_156, color = x), size = 2, shape = 7) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 20
p8 <- ggplot(centrobank) + geom_point(aes(x = x, y = INR_356, color = x), size = 2, shape = 9) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 21
g2 <- grid.arrange(p5, p6, p7, p8, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_10_1.png', g2, width = 18, height = 24)
# Chunk 22
p9 <- ggplot(centrobank, aes (x = x, y=foreign_exchange_reserves, color = foreign_exchange_reserves)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=foreign_exchange_reserves), color = '#FF6633') + theme_bw() + ylab('foreign exchange reserves, millions of US dollars')
# Chunk 23
p10 <- ggplot(centrobank, aes (x=x, y=monetary_gold, color = monetary_gold)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=monetary_gold), color = '#00FFFF') + theme_bw() + ylab('monetary gold reserves, millions of US dollars')
# Chunk 24
g3 <- grid.arrange(p9, p10, ncol = 1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_13_1.png', g3, width = 12, height = 24)
# Chunk 25
corr_centrobank <-centrobank[, c(2,3,4,7,10,11,14,15,16,17,18,19,20)]
# Chunk 26
chart.Correlation(corr_centrobank, histogram=TRUE, pch=19)
# Chunk 27
p11 <- ggplot(centrobank, aes (x=dual_currency_basket, y=gold, color = gold)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 28
p12 <- ggplot(centrobank, aes (x=dual_currency_basket, y=silver, color = silver)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 29
p13 <- ggplot(centrobank, aes (x=dual_currency_basket, y=platinum, color = platinum)) + geom_line() + geom_smooth(color='darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 30
p14 <- ggplot(centrobank, aes (x=dual_currency_basket, y=palladium, color = palladium)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 31
g4 <- grid.arrange(p11, p12, p13, p14, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_7_1.png', g4, width = 18, height = 24)
# Chunk 32
p15 <- ggplot(centrobank, aes (x=dual_currency_basket, y=JPY_392, color = JPY_392)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 33
p16 <- ggplot(centrobank, aes (x=dual_currency_basket, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 34
p17 <- ggplot(centrobank, aes (x=dual_currency_basket, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color='darkred')+ scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 35
p18 <- ggplot(centrobank, aes (x=JPY_392, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 36
p19 <- ggplot(centrobank, aes (x=CNY_156, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 37
p20 <- ggplot(centrobank, aes (x=JPY_392, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 38
g5 <- grid.arrange(p15, p16, p17, p18, p19, p20, ncol = 3)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_14_1.png', g5, width = 18, height = 24)
# Chunk 39
p21 <- ggplot(centrobank, aes (x=foreign_exchange_reserves, y=monetary_gold, color = monetary_gold)) + geom_jitter(shape = 13, size = 4) + geom_smooth(color = '#00FF99') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
p21
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_15_1.png', p21, width = 12, height = 8)
# Chunk 40
with(centrobank, cor.test(dual_currency_basket, gold))
with(centrobank, cor.test(dual_currency_basket, silver))
with(centrobank, cor.test(dual_currency_basket, platinum))
with(centrobank, cor.test(dual_currency_basket, palladium))
# Chunk 41
with(centrobank, cor.test(dual_currency_basket, JPY_392))
with(centrobank, cor.test(dual_currency_basket, CNY_156))
with(centrobank, cor.test(dual_currency_basket, INR_356))
with(centrobank, cor.test(JPY_392, CNY_156))
with(centrobank, cor.test(JPY_392, INR_356))
with(centrobank, cor.test(INR_356, CNY_156))
# Chunk 42
with(centrobank, cor.test(foreign_exchange_reserves, monetary_gold))
# Chunk 43
p24 <- ggplot(centrobank, aes(x=dual_currency_basket, y = gold, color = year)) + geom_point(shape=10, alpha=0.5, size = 2) + facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() + scale_colour_gradientn(colours=heat.colors(5)) + ggtitle('Gold prices and dual currency basket in 2012-2016, rubles') + theme_bw()
ggplotly(p24)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Multivariate_Plots_1_1.png', p24, width = 18, height = 12)
# Chunk 44
pl1 <- plot_ly(centrobank, x=EUR_978, y=USD_840, z=gold, color = gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
# Chunk 45
pl2 <- plot_ly(centrobank, x=gold, y=silver, z=dual_currency_basket, color = dual_currency_basket, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
# Chunk 46
m1 <- lm(gold ~ dual_currency_basket, data = centrobank)
m2 <- update(m1, ~ . + platinum)
m3 <- update(m2, ~ . + palladium)
m4 <- update(m3, ~ . + silver)
mtable(m1, m2, m3, m4)
# Chunk 47
mcorr_centrobank <- cor(corr_centrobank)
corrplot.mixed(mcorr_centrobank, lower="number", upper="pie", order ="AOE", tl.col="darkblue", tl.cex=0.5)
# Chunk 48
p22 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=centrobank$gold), color = 'goldenrod1', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$gold), color = 'gold') +
geom_text(data=centrobank, mapping=aes(y=centrobank$gold), label='G',size=4, color ='orange') +
geom_point(aes(y=100*centrobank$silver), color = 'darkgrey', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=100*centrobank$silver), color = 'grey') +
geom_text(data=centrobank, mapping=aes(y=100*centrobank$silver), label='S',size=4, color ='black') +
geom_point(aes(y=centrobank$palladium), color = 'brown', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$palladium), color = 'sienna2') +
geom_text(data=centrobank, mapping=aes(y=centrobank$palladium),label='Pa', size=3, color ='#663300') +
geom_point(aes(y=centrobank$platinum), color = 'darkcyan', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$platinum), color = 'darkseagreen3') +
geom_text(data=centrobank, mapping=aes(y=centrobank$platinum), label='Pl', size=3, color ='darkgreen') +
ylab('1g palladium, 1g platinum, 100g siver, 1g gold prices') +
ggtitle('Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
# Chunk 49
note1 = 'JPY'
note2 = 'USD'
note3 = 'EUR'
note4 = 'CNY'
note5 = 'INR'
x1 = centrobank[1000,1]
y1 = 100*centrobank[1000,7]
x2 = centrobank[4,1]
y2 = centrobank[4,4]
x3 = centrobank[7,1]
y3 = centrobank[7,3]
x4 = centrobank[920,1]
y4 = 10*centrobank[920,10]
x5 = centrobank[1080,1]
y5 = 100*centrobank[1080,14]
# Chunk 50
p23 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=100*centrobank$JPY_392), color = 'darkred', shape=10, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$USD_840, label=note2), color = 'darkblue', shape=11, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$EUR_978), color = 'darkgreen', shape=12, alpha=0.7, size = 2) +
geom_point(aes(y=10*centrobank$CNY_156), color = 'purple3', shape=13, alpha=0.7, size = 2) +
geom_point(aes(y=100*centrobank$INR_356), color = 'orange', shape=14, alpha=0.7, size = 2) +
geom_smooth(aes(y=100*centrobank$JPY_392), color = 'red') +
geom_smooth(aes(y=centrobank$USD_840), color = 'blue') +
geom_smooth(aes(y=centrobank$EUR_978), color = 'green') +
geom_smooth(aes(y=10*centrobank$CNY_156), color = 'magenta') +
geom_smooth(aes(y=100*centrobank$INR_356), color = 'yellow') +
annotate(geom="text",x=as.Date(x1),y=y1,label=note1,fontface="bold",size = 8,color = "red") +
annotate(geom="text",x=as.Date(x2),y=y2,label=note2,fontface="bold",size = 8,color = "blue") +
annotate(geom="text",x=as.Date(x3),y=y3,label=note3,fontface="bold",size = 8,color = "green") +
annotate(geom="text",x=as.Date(x4),y=y4,label=note4,fontface="bold",size = 8,color="magenta") +
annotate(geom="text",x=as.Date(x5),y=y5,label=note5,fontface="bold",size = 8,color="yellow") +
ylab('100 JRY, USD, EUR, 10 CNY, 100 INR') +
ggtitle('Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
# Chunk 51
g11 <- grid.arrange(p22, p23, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Plot_Two_4_1.png', g11, width = 18, height = 24)
# Chunk 52
p25 <- ggplot(centrobank, aes(x=dual_currency_basket, y = (gold+silver+platinum+palladium)/4, color = year)) + geom_point(shape=7, alpha=0.5, size = 2) + geom_smooth() + scale_colour_gradientn(colours=rainbow(5)) + ggtitle('Precious metals mean of prices and dual currency basket in 2012-2016, rubles') + theme_bw()
# Chunk 53
p26 <- ggplot(centrobank, aes(x=dual_currency_basket, y = (gold+silver+platinum+palladium)/4, color = year)) + geom_point(shape=7, alpha=0.5, size = 2) + facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() + scale_colour_gradientn(colours=rainbow(5)) + ggtitle('Precious metals mean of prices and dual currency basket in 2012-2016, rubles') + theme_bw()
# Chunk 54
g12 <- grid.arrange(p25, p26, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Plot_Three_3_1.png', g12, width = 18, height = 24)
str(centrobank)
# http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf
# http://www.cookbook-r.com/Graphs/Shapes_and_line_types/
# http://www.ats.ucla.edu/stat/r/faq/smooths.htm
# http://docs.ggplot2.org/current/scale_brewer.html
# http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/
# https://www.r-bloggers.com/from-continuous-to-categorical/
?diamonds
p22 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=centrobank$gold), color = 'goldenrod1', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$gold), color = 'gold') +
geom_text(data=centrobank, mapping=aes(y=centrobank$gold), label='G',size=4, color ='orange') +
geom_point(aes(y=100*centrobank$silver), color = 'darkgrey', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=100*centrobank$silver), color = 'grey') +
geom_text(data=centrobank, mapping=aes(y=100*centrobank$silver), label='S',size=4, color ='black') +
geom_point(aes(y=centrobank$palladium), color = 'brown', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$palladium), color = 'sienna2') +
geom_text(data=centrobank, mapping=aes(y=centrobank$palladium),label='Pa', size=3, color ='#663300') +
geom_point(aes(y=centrobank$platinum), color = 'darkcyan', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$platinum), color = 'darkseagreen3') +
geom_text(data=centrobank, mapping=aes(y=centrobank$platinum), label='Pl', size=3, color ='darkgreen') +
ylab('1g palladium, 1g platinum, 100g siver, 1g gold prices') +
ggtitle('Data of Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
p23 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=100*centrobank$JPY_392), color = 'darkred', shape=10, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$USD_840, label=note2), color = 'darkblue', shape=11, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$EUR_978), color = 'darkgreen', shape=12, alpha=0.7, size = 2) +
geom_point(aes(y=10*centrobank$CNY_156), color = 'purple3', shape=13, alpha=0.7, size = 2) +
geom_point(aes(y=100*centrobank$INR_356), color = 'orange', shape=14, alpha=0.7, size = 2) +
geom_smooth(aes(y=100*centrobank$JPY_392), color = 'red') +
geom_smooth(aes(y=centrobank$USD_840), color = 'blue') +
geom_smooth(aes(y=centrobank$EUR_978), color = 'green') +
geom_smooth(aes(y=10*centrobank$CNY_156), color = 'magenta') +
geom_smooth(aes(y=100*centrobank$INR_356), color = 'yellow') +
annotate(geom="text",x=as.Date(x1),y=y1,label=note1,fontface="bold",size = 8,color = "red") +
annotate(geom="text",x=as.Date(x2),y=y2,label=note2,fontface="bold",size = 8,color = "blue") +
annotate(geom="text",x=as.Date(x3),y=y3,label=note3,fontface="bold",size = 8,color = "green") +
annotate(geom="text",x=as.Date(x4),y=y4,label=note4,fontface="bold",size = 8,color="magenta") +
annotate(geom="text",x=as.Date(x5),y=y5,label=note5,fontface="bold",size = 8,color="yellow") +
ylab('100 JRY, USD, EUR, 10 CNY, 100 INR') +
ggtitle('Data of Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
g11 <- grid.arrange(p22, p23, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Plot_Two_4_1.png', g11, width = 18, height = 24)
pl1 <- plot_ly(centrobank, x=EUR_978, y=USD_840, z=gold, color = gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
setwd('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4')
# Chunk 3
library(devtools)
library(knitr)
library(markdown)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(gridExtra)
library(scales)
library(reshape2)
library(plyr)
library(GGally)
library(dplyr)
library(tidyr)
library(xlsx)
library(lubridate)
# Chunk 4
library(corrplot)
library(PerformanceAnalytics)
library(plotly)
library(RCurl)
library(bitops)
library(memisc)
# Chunk 5
centrobank <- data.frame(read.xlsx("c_bank.xlsx", sheetName="Data", header=TRUE))
head(centrobank)
# Chunk 6
row.with.na <- apply(centrobank, 1, function(x){any(is.na(x))})
s <- sum(row.with.na)
cat('sum(row.with.na) = ', s)
# Chunk 7
str(centrobank)
# Chunk 8
summary(centrobank)
# Chunk 9
centrobank$temp1 <- gsub(" ","", centrobank$foreign_exchange_reserves)
centrobank$foreign_exchange_reserves <- as.numeric(centrobank$temp1)
centrobank$temp2 <- gsub(" ","", centrobank$monetary_gold)
centrobank$monetary_gold <- as.numeric(centrobank$temp2)
summary(centrobank$foreign_exchange_reserves)
summary(centrobank$monetary_gold)
# Chunk 10
drops <- c("temp1","temp2")
centrobank <- centrobank[ , !(names(centrobank) %in% drops)]
# Chunk 11
centrobank$day= as.numeric(format(centrobank$date, "%d"))
centrobank$month = format(centrobank$date, "%B")
centrobank$year = as.numeric(format(centrobank$date, "%Y"))
str(centrobank)
# Chunk 12
p1 <- ggplot(aes(x = gold), data = centrobank) +
geom_histogram(binwidth = 50, color = 'purple', aes(fill = ..count..)) +
scale_x_continuous(name = 'gold, rubles per gram',
limits=c(1200, 3200), breaks=seq(1200, 3200, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 13
p2 <- ggplot(aes(x = silver), data = centrobank) +
geom_histogram(binwidth = 0.5, color ='darkblue', aes(fill = ..count..)) +
scale_x_continuous(name = 'silver, rubles per gram',
limits = c(19, 44), breaks = seq(19, 44, 0.5)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 14
p3 <- ggplot(aes(x = platinum), data = centrobank) +
geom_histogram(binwidth = 50, color = 'darkmagenta', aes(fill = ..count..)) +
scale_x_continuous(name = 'platinum, rubles per gram', limits = c(1200, 2800), breaks=seq(1200, 2800, 50)) +
scale_fill_gradientn(colours=heat.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 15
p4 <- ggplot(aes(x = palladium), data = centrobank) +
geom_histogram(binwidth = 30, color = 'blue', aes(fill = ..count..)) +
scale_x_continuous(name = 'palladium, rubles per gram', limits = c(550, 1750), breaks=seq(550, 1750, 30)) +
scale_fill_gradientn(colours=terrain.colors(20)) +
theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
# Chunk 16
g1 <- grid.arrange(p1, p2, p3, p4, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_5_1.png', g1, width = 18, height = 24)
# Chunk 17
data_length = length(centrobank$BRL_986)
x = seq(1, data_length)
p5 <- ggplot(centrobank) + geom_point(aes(x = x, y = BRL_986, color = x), size = 2, shape = 5) + scale_colour_gradient2_tableau('Red-Blue') + theme_bw()
# Chunk 18
p6 <- ggplot(centrobank) + geom_point(aes(x = x, y = JPY_392, color = x), size = 2, shape = 12) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 19
p7 <-ggplot(centrobank) + geom_point(aes(x = x, y = CNY_156, color = x), size = 2, shape = 7) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 20
p8 <- ggplot(centrobank) + geom_point(aes(x = x, y = INR_356, color = x), size = 2, shape = 9) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
# Chunk 21
g2 <- grid.arrange(p5, p6, p7, p8, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_10_1.png', g2, width = 18, height = 24)
# Chunk 22
p9 <- ggplot(centrobank, aes (x = x, y=foreign_exchange_reserves, color = foreign_exchange_reserves)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=foreign_exchange_reserves), color = '#FF6633') + theme_bw() + ylab('foreign exchange reserves, millions of US dollars')
# Chunk 23
p10 <- ggplot(centrobank, aes (x=x, y=monetary_gold, color = monetary_gold)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=monetary_gold), color = '#00FFFF') + theme_bw() + ylab('monetary gold reserves, millions of US dollars')
# Chunk 24
g3 <- grid.arrange(p9, p10, ncol = 1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Univariate_Plots_13_1.png', g3, width = 12, height = 24)
# Chunk 25
corr_centrobank <-centrobank[, c(2,3,4,7,10,11,14,15,16,17,18,19,20)]
# Chunk 26
chart.Correlation(corr_centrobank, histogram=TRUE, pch=19)
# Chunk 27
p11 <- ggplot(centrobank, aes (x=dual_currency_basket, y=gold, color = gold)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 28
p12 <- ggplot(centrobank, aes (x=dual_currency_basket, y=silver, color = silver)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 29
p13 <- ggplot(centrobank, aes (x=dual_currency_basket, y=platinum, color = platinum)) + geom_line() + geom_smooth(color='darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 30
p14 <- ggplot(centrobank, aes (x=dual_currency_basket, y=palladium, color = palladium)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 31
g4 <- grid.arrange(p11, p12, p13, p14, ncol = 2)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_7_1.png', g4, width = 18, height = 24)
# Chunk 32
p15 <- ggplot(centrobank, aes (x=dual_currency_basket, y=JPY_392, color = JPY_392)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 33
p16 <- ggplot(centrobank, aes (x=dual_currency_basket, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 34
p17 <- ggplot(centrobank, aes (x=dual_currency_basket, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color='darkred')+ scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
# Chunk 35
p18 <- ggplot(centrobank, aes (x=JPY_392, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 36
p19 <- ggplot(centrobank, aes (x=CNY_156, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 37
p20 <- ggplot(centrobank, aes (x=JPY_392, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
# Chunk 38
g5 <- grid.arrange(p15, p16, p17, p18, p19, p20, ncol = 3)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_14_1.png', g5, width = 18, height = 24)
# Chunk 39
p21 <- ggplot(centrobank, aes (x=foreign_exchange_reserves, y=monetary_gold, color = monetary_gold)) + geom_jitter(shape = 13, size = 4) + geom_smooth(color = '#00FF99') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
p21
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Bivariate_Plots_15_1.png', p21, width = 12, height = 8)
# Chunk 40
with(centrobank, cor.test(dual_currency_basket, gold))
with(centrobank, cor.test(dual_currency_basket, silver))
with(centrobank, cor.test(dual_currency_basket, platinum))
with(centrobank, cor.test(dual_currency_basket, palladium))
# Chunk 41
with(centrobank, cor.test(dual_currency_basket, JPY_392))
with(centrobank, cor.test(dual_currency_basket, CNY_156))
with(centrobank, cor.test(dual_currency_basket, INR_356))
with(centrobank, cor.test(JPY_392, CNY_156))
with(centrobank, cor.test(JPY_392, INR_356))
with(centrobank, cor.test(INR_356, CNY_156))
# Chunk 42
with(centrobank, cor.test(foreign_exchange_reserves, monetary_gold))
# Chunk 43
p24 <- ggplot(centrobank, aes(x=dual_currency_basket, y = gold, color = year)) + geom_point(shape=10, alpha=0.5, size = 2) + facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() + scale_colour_gradientn(colours=heat.colors(5)) + ggtitle('Gold prices and dual currency basket in 2012-2016, rubles') + theme_bw()
ggplotly(p24)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Multivariate_Plots_1_1.png', p24, width = 18, height = 12)
# Chunk 44
pl1 <- plot_ly(centrobank, x=EUR_978, y=USD_840, z=gold, color = gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
# Chunk 45
pl2 <- plot_ly(centrobank, x=gold, y=silver, z=dual_currency_basket, color = dual_currency_basket, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
# Chunk 46
m1 <- lm(gold ~ dual_currency_basket, data = centrobank)
m2 <- update(m1, ~ . + platinum)
m3 <- update(m2, ~ . + palladium)
m4 <- update(m3, ~ . + silver)
mtable(m1, m2, m3, m4)
# Chunk 47
mcorr_centrobank <- cor(corr_centrobank)
corrplot.mixed(mcorr_centrobank, lower="number", upper="pie", order ="AOE", tl.col="darkblue", tl.cex=0.5)
# Chunk 48
p22 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=centrobank$gold), color = 'goldenrod1', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$gold), color = 'gold') +
geom_text(data=centrobank, mapping=aes(y=centrobank$gold), label='G',size=4, color ='orange') +
geom_point(aes(y=100*centrobank$silver), color = 'darkgrey', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=100*centrobank$silver), color = 'grey') +
geom_text(data=centrobank, mapping=aes(y=100*centrobank$silver), label='S',size=4, color ='black') +
geom_point(aes(y=centrobank$palladium), color = 'brown', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$palladium), color = 'sienna2') +
geom_text(data=centrobank, mapping=aes(y=centrobank$palladium),label='Pa', size=3, color ='#663300') +
geom_point(aes(y=centrobank$platinum), color = 'darkcyan', shape=1, alpha=0.7, size = 5) +
geom_smooth(aes(y=centrobank$platinum), color = 'darkseagreen3') +
geom_text(data=centrobank, mapping=aes(y=centrobank$platinum), label='Pl', size=3, color ='darkgreen') +
ylab('1g palladium, 1g platinum, 100g siver, 1g gold prices') +
ggtitle('Data of Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
# Chunk 49
note1 = 'JPY'
note2 = 'USD'
note3 = 'EUR'
note4 = 'CNY'
note5 = 'INR'
x1 = centrobank[1000,1]
y1 = 100*centrobank[1000,7]
x2 = centrobank[4,1]
y2 = centrobank[4,4]
x3 = centrobank[7,1]
y3 = centrobank[7,3]
x4 = centrobank[920,1]
y4 = 10*centrobank[920,10]
x5 = centrobank[1080,1]
y5 = 100*centrobank[1080,14]
# Chunk 50
p23 <- ggplot(data = centrobank, aes(x = date)) +
geom_point(aes(y=100*centrobank$JPY_392), color = 'darkred', shape=10, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$USD_840, label=note2), color = 'darkblue', shape=11, alpha=0.7, size = 2) +
geom_point(aes(y=centrobank$EUR_978), color = 'darkgreen', shape=12, alpha=0.7, size = 2) +
geom_point(aes(y=10*centrobank$CNY_156), color = 'purple3', shape=13, alpha=0.7, size = 2) +
geom_point(aes(y=100*centrobank$INR_356), color = 'orange', shape=14, alpha=0.7, size = 2) +
geom_smooth(aes(y=100*centrobank$JPY_392), color = 'red') +
geom_smooth(aes(y=centrobank$USD_840), color = 'blue') +
geom_smooth(aes(y=centrobank$EUR_978), color = 'green') +
geom_smooth(aes(y=10*centrobank$CNY_156), color = 'magenta') +
geom_smooth(aes(y=100*centrobank$INR_356), color = 'yellow') +
annotate(geom="text",x=as.Date(x1),y=y1,label=note1,fontface="bold",size = 8,color = "red") +
annotate(geom="text",x=as.Date(x2),y=y2,label=note2,fontface="bold",size = 8,color = "blue") +
annotate(geom="text",x=as.Date(x3),y=y3,label=note3,fontface="bold",size = 8,color = "green") +
annotate(geom="text",x=as.Date(x4),y=y4,label=note4,fontface="bold",size = 8,color="magenta") +
annotate(geom="text",x=as.Date(x5),y=y5,label=note5,fontface="bold",size = 8,color="yellow") +
ylab('100 JRY, USD, EUR, 10 CNY, 100 INR') +
ggtitle('Data of Bank of Russia, 2012-2016') + theme_bw() +
theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
# Chunk 51
g11 <- grid.arrange(p22, p23, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Plot_Two_4_1.png', g11, width = 18, height = 24)
# Chunk 52
p25 <- ggplot(centrobank, aes(x=dual_currency_basket, y = (gold+silver+platinum+palladium)/4, color = year)) + geom_point(shape=7, alpha=0.5, size = 2) + geom_smooth() + scale_colour_gradientn(colours=rainbow(5)) + ggtitle('Precious metals mean of prices and dual currency basket in 2012-2016, rubles') + theme_bw()
# Chunk 53
p26 <- ggplot(centrobank, aes(x=dual_currency_basket, y = (gold+silver+platinum+palladium)/4, color = year)) + geom_point(shape=7, alpha=0.5, size = 2) + facet_wrap( ~ year, ncol=3, scale = 'free') + geom_smooth() + scale_colour_gradientn(colours=rainbow(5)) + ggtitle('Precious metals mean of prices and dual currency basket in 2012-2016, rubles') + theme_bw()
# Chunk 54
g12 <- grid.arrange(p25, p26, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure_html/Plot_Three_3_1.png', g12, width = 18, height = 24)
View(centrobank)
View(centrobank)
pl1 <- plot_ly(centrobank, x=EUR_978, y=USD_840, z=gold, color = gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
library(corrplot)
library(PerformanceAnalytics)
library(plotly)
library(RCurl)
library(bitops)
library(memisc)
pl2 <- plot_ly(centrobank, x=gold, y=silver, z=dual_currency_basket, color = dual_currency_basket, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
pl2 <- plot_ly(centrobank, x=centrobank$gold, y=centrobank$silver, z=cebtrobank$dual_currency_basket, color = centrobank$dual_currency_basket, text = paste(centrobank$date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
pl2 <- plot_ly(centrobank, x=centrobank$gold, y=centrobank$silver, z=centrobank$dual_currency_basket, color = centrobank$dual_currency_basket, text = paste(centrobank$date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
pl1 <- plot_ly(centrobank, x=centrobank$EUR_978, y=centrobank$USD_840, z=centrobank$gold, color = centrobank$gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
pl1 <- plot_ly(centrobank, x=centrobank$EUR_978, y=centrobank$USD_840, z=centrobank$gold, color = centrobank$gold, text = paste(centrobank$date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
