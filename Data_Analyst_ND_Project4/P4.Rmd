---
title: 'P4: Explore and Summarize Data. Data of the Bank of Russia'
author: "Olga Belitskaya"
date: '15/08/2016'
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Tools

##### Let's start the description of the project with definition of working tools: the directory for storing generated files, the list of downloaded packages and the collection of useful links.

## 1.1 Setup Working Directory
'/Users/olgabelitskaya/version-control/reflections-ud651'

```{r echo=FALSE, Working_Directory}
setwd('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4')
```

## 1.2 Useful links

1) http://www.theanalysisfactor.com/interpreting-regression-coefficients/

2) http://docs.ggplot2.org/current/coord_trans.html

3) https://www.r-bloggers.com/interpreting-regression-coefficient-in-r/?utm_source=feedburner&utm_medium=email&utm_campaign=Feed%3A+RBloggers+%28R+bloggers%29

4) http://personality-project.org/r/html/corr.test.html

5) https://rpubs.com/hadley/ggplot2-layers

6) http://rmarkdown.rstudio.com/articles_integration.html

7) https://http://blog.yhat.com/posts/r-lm-summary.html

8) http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/

9) http://data.princeton.edu/R/linearModels.html

10) https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf

## 1.3 Libraries

List of the libraries: 
devtools, knitr, markdown, ggplot2, ggthemes, RColorBrewer, gridExtra, scales,
reshape2, plyr, GGally, dplyr, tidyr, xlsx, lubridate.

```{r echo=FALSE, message=FALSE, warning=FALSE, Libraries_1}
library(devtools)
library(knitr)
library(markdown)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(gridExtra)
library(scales)
library(reshape2)
library(plyr)
library(GGally)
library(dplyr)
library(tidyr)
library(xlsx)
library(lubridate)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Libraries_2}
library(corrplot)
library(PerformanceAnalytics)
library(plotly)
library(RCurl)
library(bitops)
library(memisc)
```

# 2. Data

## 2.1 Introduction
##### I have chosen an open database of quotations of currencies and precious metals located on the site of the Bank of Russia. 

http://www.cbr.ru/Eng/hd_base/

##### I think it is easy to visualize the analysis of variables and dependencies in this case. From publicly available data the file in xlsx format has been generated and downloaded.

## 2.2 Load the Data and Review

##### Using suitable fuctions (read.xlsx, data.frame) I had read the file as a dataframe. It was called "centrobank".

```{r echo=FALSE, Data_1}
centrobank <- data.frame(read.xlsx("c_bank.xlsx", sheetName="Data", header=TRUE))
head(centrobank)
```

##### First, there were no values "NA" in this dataframe, it was specially checked.

```{r echo=FALSE, Data_2}
row.with.na <- apply(centrobank, 1, function(x){any(is.na(x))})
s <- sum(row.with.na)
cat('sum(row.with.na) = ', s)
```

##### Second, let us have a look on dataframe components (variables and their types, values, etc.).

```{r echo=FALSE, Data_3}
str(centrobank)
```

##### Third, we should notice that variables that indicating exchange rates are measured in rubles, the prices of precious metals are denoted in rubles per gram, foreign exchange reserves and monetary gold reserves in RF - in millions of US dollars for every month.

```{r echo=FALSE, Data_4}
summary(centrobank)
```
##### Finally, as we could see some variables (foreign_exchange_reserves, monetary_gold) have the wrong type. It means the investigation proceeds to the next step.

## 2.3 Cleaning and Managing Data

##### With some special functions I added the right category (numerical) for foreign_exchange_reserves and monetary_gold.

```{r echo=FALSE, Data_5}
centrobank$temp1 <- gsub(" ","", centrobank$foreign_exchange_reserves)
centrobank$foreign_exchange_reserves <- as.numeric(centrobank$temp1)

centrobank$temp2 <- gsub(" ","", centrobank$monetary_gold)
centrobank$monetary_gold <- as.numeric(centrobank$temp2)

summary(centrobank$foreign_exchange_reserves)
summary(centrobank$monetary_gold)
```

```{r echo=FALSE, Data_6}
drops <- c("temp1","temp2")
centrobank <- centrobank[ , !(names(centrobank) %in% drops)]
```

##### For the next steps it would be useful to have variables with separated date indicators (days, months and years), so I had added these variables.

```{r echo=FALSE, Data_7}
centrobank$day= as.numeric(format(centrobank$date, "%d"))
centrobank$month = format(centrobank$date, "%B") 
centrobank$year = as.numeric(format(centrobank$date, "%Y"))
str(centrobank)
```

# 3. Univariate Plots Section

## 3.1 Univariate Plots

##### 3.1.1 Plots for prices of precious metals.

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_1}
p1 <- ggplot(aes(x = gold), data = centrobank) + 
  geom_histogram(binwidth = 50, color = 'purple', aes(fill = ..count..)) + 
  scale_x_continuous(name = 'gold, rubles per gram', 
                     limits=c(1200, 3200), breaks=seq(1200, 3200, 50)) + 
  scale_fill_gradientn(colours=heat.colors(20)) + 
  theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_2}
p2 <- ggplot(aes(x = silver), data = centrobank) + 
  geom_histogram(binwidth = 0.5, color ='darkblue', aes(fill = ..count..)) + 
  scale_x_continuous(name = 'silver, rubles per gram', 
                     limits = c(19, 44), breaks = seq(19, 44, 0.5)) + 
  scale_fill_gradientn(colours=terrain.colors(20)) + 
  theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_3}
p3 <- ggplot(aes(x = platinum), data = centrobank) + 
  geom_histogram(binwidth = 50, color = 'darkmagenta', aes(fill = ..count..)) + 
  scale_x_continuous(name = 'platinum, rubles per gram', limits = c(1200, 2800), breaks=seq(1200, 2800, 50)) + 
  scale_fill_gradientn(colours=heat.colors(20)) + 
  theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_4}
p4 <- ggplot(aes(x = palladium), data = centrobank) + 
  geom_histogram(binwidth = 30, color = 'blue', aes(fill = ..count..)) + 
  scale_x_continuous(name = 'palladium, rubles per gram', limits = c(550, 1750), breaks=seq(550, 1750, 30)) + 
  scale_fill_gradientn(colours=terrain.colors(20)) + 
  theme_bw() + theme(axis.text.x=element_text(size=8, angle=85),axis.title=element_text(size=12))
```

```{r fig.width=14, fig.height=8, echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_5}
g1 <- grid.arrange(p1, p2, p3, p4, ncol = 2)

ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Univariate_Plots_5-1.png', g1, width = 18, height = 24) 
```

##### 3.1.2 Plots for exchange rates (BRL 986, JPY 392, CNY 156, INR 356).

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_6}
data_length = length(centrobank$BRL_986)
x = seq(1, data_length)
p5 <- ggplot(centrobank) + geom_point(aes(x = x, y = BRL_986, color = x), size = 2, shape = 5) + scale_colour_gradient2_tableau('Red-Blue') + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_7}
p6 <- ggplot(centrobank) + geom_point(aes(x = x, y = JPY_392, color = x), size = 2, shape = 12) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_8}
p7 <-ggplot(centrobank) + geom_point(aes(x = x, y = CNY_156, color = x), size = 2, shape = 7) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_9}
p8 <- ggplot(centrobank) + geom_point(aes(x = x, y = INR_356, color = x), size = 2, shape = 9) + scale_colour_gradient2_tableau('Temperature') + theme_bw()
```

```{r fig.width=14, fig.height=8, echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_10}
g2 <- grid.arrange(p5, p6, p7, p8, ncol = 2)

ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Univariate_Plots_10-1.png', g2, width = 18, height = 24) 
```

##### 3.1.3 Plots for foreign exchange and monetary gold reserves.

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_11}
p9 <- ggplot(centrobank, aes (x = x, y=foreign_exchange_reserves, color = foreign_exchange_reserves)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=foreign_exchange_reserves), color = '#FF6633') + theme_bw() + ylab('foreign exchange reserves, millions of US dollars')
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_12}
p10 <- ggplot(centrobank, aes (x=x, y=monetary_gold, color = monetary_gold)) + geom_jitter(size = 2, alpha=0.3, shape = 6) + scale_colour_gradientn(colours=rainbow(10)) + geom_smooth(aes(y=monetary_gold), color = '#00FFFF') + theme_bw() + ylab('monetary gold reserves, millions of US dollars')
```

```{r fig.width=14, fig.height=8, echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots_13}
g3 <- grid.arrange(p9, p10, ncol = 1)

ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Univariate_Plots_13-1.png', g3, width = 12, height = 24) 
```

## 3.2. Univariate Analysis

##### The structure of my data is the set of the main financial indicators. Only with the first look at the data we could see the similar tendencies in many different cases. So we could predict many dependencies between our variables.

##### Also these indicators show the situation in the country economy in general. For sure it's an interesting subject for investigations.

##### The graphic description of histograms for precious metals: they have a non-symmetrical form, skewed right and multimodal. For gold and platinum we could see a tendency to be unimodal, for silver and palladium - to be bimodal. In practice it means that the prices of gold and platinum were stable at a certain interval for a sufficiently long period of time; for silver and palladium there were two not so long periods of stability. Dispersion of prices is also quite large. The significant price increase in relation to the national currency allows us to consider that the precious metals are reasonable investment.

##### Next graphs show various exchange trends for the Brazilian real and the Asian currencies. The Brazilian real has one rise relative to the Russian ruble, Asian currencies have many peaks. However, there are certain similarities too: a period of small oscillations in the beginning of the chart gave way to a period of sharp spikes.

##### The plots for foreign exchange and monetary gold reserves demonstrate diametrically opposed situation in the resources in the second half of the time interval: the foreign exchange reserves show a downward trend, stocks of monetary gold - a steady rise.

# 4 Bivariate Plots Section

## 4.1 Bivariate Plots

##### 4.1.1 Plots for all pairs of variables.

```{r echo=FALSE, message=FALSE, warning=FALSE, comment='', Correlation_Plots_1}
corr_centrobank <-centrobank[, c(2,3,4,7,10,11,14,15,16,17,18,19,20)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE, comment='', Correlation_Plots_2}
chart.Correlation(corr_centrobank, histogram=TRUE, pch=19)
```

##### The tables shows a strong correlation between the number of variables, we will examine in detail only some of them.

##### 4.1.2 Plots for prices of precious metals and the dual currency basket.

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_3}
p11 <- ggplot(centrobank, aes (x=dual_currency_basket, y=gold, color = gold)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_4}
p12 <- ggplot(centrobank, aes (x=dual_currency_basket, y=silver, color = silver)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_5}
p13 <- ggplot(centrobank, aes (x=dual_currency_basket, y=platinum, color = platinum)) + geom_line() + geom_smooth(color='darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_6}
p14 <- ggplot(centrobank, aes (x=dual_currency_basket, y=palladium, color = palladium)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
```

```{r fig.width=14, fig.height=8, echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_7}
g4 <- grid.arrange(p11, p12, p13, p14, ncol = 2)

ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Bivariate_Plots_7-1.png', g4, width = 18, height = 24) 
```

##### 4.1.3 Plots for Asian exchange rates and the dual currency basket.

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_8}
p15 <- ggplot(centrobank, aes (x=dual_currency_basket, y=JPY_392, color = JPY_392)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_9}
p16 <- ggplot(centrobank, aes (x=dual_currency_basket, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkred') + scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_10}
p17 <- ggplot(centrobank, aes (x=dual_currency_basket, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color='darkred')+ scale_colour_gradientn(colours=heat.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_11}
p18 <- ggplot(centrobank, aes (x=JPY_392, y=CNY_156, color = CNY_156)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_12}
p19 <- ggplot(centrobank, aes (x=CNY_156, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_13}
p20 <- ggplot(centrobank, aes (x=JPY_392, y=INR_356, color = INR_356)) + geom_line() + geom_smooth(color = 'darkgreen') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
```

```{r fig.width=14, fig.height=12, echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_14}
g5 <- grid.arrange(p15, p16, p17, p18, p19, p20, ncol = 3)

ggsave('/Users/olgabelitskaya//projects/nd002/Data_Analyst_ND_Project4/figure-html/Bivariate_Plots_14-1.png', g5, width = 18, height = 24) 
```

##### 4.1.4 Plots for foreign exchange reserves and monetary gold reserves.

```{r fig.width=8, fig.height=6, echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_15}
p21 <- ggplot(centrobank, aes (x=foreign_exchange_reserves, y=monetary_gold, color = monetary_gold)) + geom_jitter(shape = 13, size = 4) + geom_smooth(color = '#00FF99') + scale_colour_gradientn(colours=terrain.colors(10)) + theme_bw()
p21
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Bivariate_Plots_15-1.png', p21, width = 12, height = 8)
```

## 4.2 Bivariate Analysis

##### Let's start with correlation tests for these plotted pairs of variables.

```{r echo=FALSE, message=FALSE, warning=FALSE, comment='', Correlation_Tests_1}
with(centrobank, cor.test(dual_currency_basket, gold))
with(centrobank, cor.test(dual_currency_basket, silver))
with(centrobank, cor.test(dual_currency_basket, platinum))
with(centrobank, cor.test(dual_currency_basket, palladium))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, comment='', Correlation_Tests_2}
with(centrobank, cor.test(dual_currency_basket, JPY_392))
with(centrobank, cor.test(dual_currency_basket, CNY_156))
with(centrobank, cor.test(dual_currency_basket, INR_356))
with(centrobank, cor.test(JPY_392, CNY_156))
with(centrobank, cor.test(JPY_392, INR_356))
with(centrobank, cor.test(INR_356, CNY_156))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, comment='', background='#F7F7F7', Correlation_Tests_3}
with(centrobank, cor.test(foreign_exchange_reserves, monetary_gold))
```

##### Most of the observed relationships have strong positive correlation (dual_currency_basket & gold, dual_currency_basket & platinum, dual_currency_basket & palladium, dual_currency_basket & JPY-392, dual_currency_basket & INR-356, dual_currency_basket & CNY-156, JPY-392 & CNY-156, JPY-392 & INR-356, INR-356 & CNY-156). A moderate positive relationship is between dual_currency_basket & silver; a weak negative relationship - between foreign_exchange_reserves & monetary_gold. 

##### The strongest relationship I had found is between dual_currency_basket & CNY-156.

##### The revealed dependencies are based on cause-and-effect relationships, the fall of the national currency value in relation to a set of major currencies undoubtedly leads to the fall of this indicator in relation to other currencies and precious metals. Even a weak relationship between foreign exchange reserves and monetary gold reserves does not look accidental: reduced confidence to the foreign exchange reserves of the state leads to the accumulation of resources in another equivalent.

# 5 Multivariate Plots Section

## 5.1 Multivariate Plots

##### 5.1.1 Plots for prices of precious metals and exchange rates.

```{r echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_1}
p22<- ggplot(data = centrobank, aes(x = date)) + 
  geom_point(aes(y=centrobank$gold), color = 'goldenrod1', shape=1, alpha=0.7, size = 5) + 
  geom_smooth(aes(y=centrobank$gold), color = 'gold') + 
  geom_text(data=centrobank, mapping=aes(y=centrobank$gold), label='G',size=4, color ='orange') +
  geom_point(aes(y=100*centrobank$silver), color = 'darkgrey', shape=1, alpha=0.7, size = 5) + 
  geom_smooth(aes(y=100*centrobank$silver), color = 'grey') + 
  geom_text(data=centrobank, mapping=aes(y=100*centrobank$silver), label='S',size=4, color ='black') +
  geom_point(aes(y=centrobank$palladium), color = 'brown', shape=1, alpha=0.7, size = 5) + 
  geom_smooth(aes(y=centrobank$palladium), color = 'sienna2') + 
  geom_text(data=centrobank, mapping=aes(y=centrobank$palladium),label='Pa', size=3, color ='#663300') +
  geom_point(aes(y=centrobank$platinum), color = 'darkcyan', shape=1, alpha=0.7, size = 5) + 
  geom_smooth(aes(y=centrobank$platinum), color = 'darkseagreen3') +
  geom_text(data=centrobank, mapping=aes(y=centrobank$platinum), label='Pl', size=3, color ='darkgreen') +
  ylab('1g palladium, 1g platinum, 100g siver, 1g gold prices') + 
  ggtitle('Bank of Russia, 2012-2016') + theme_bw() +
  theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_2}
note1 = 'JPY'
note2 = 'USD'
note3 = 'EUR'
note4 = 'CNY'
note5 = 'INR'
x1 = centrobank[1000,1]
y1 = 100*centrobank[1000,7]
x2 = centrobank[4,1]
y2 = centrobank[4,4]
x3 = centrobank[7,1]
y3 = centrobank[7,3]
x4 = centrobank[920,1]
y4 = 10*centrobank[920,10]
x5 = centrobank[1080,1]
y5 = 100*centrobank[1080,14]
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_3}
p23 <- ggplot(data = centrobank, aes(x = date)) + 
  geom_point(aes(y=100*centrobank$JPY_392), color = 'darkred', shape=10, alpha=0.7, size = 4) + 
  geom_point(aes(y=centrobank$USD_840, label=note2), color = 'darkblue', shape=11, alpha=0.7, size = 4) + 
  geom_point(aes(y=centrobank$EUR_978), color = 'darkgreen', shape=12, alpha=0.7, size = 4) + 
  geom_point(aes(y=10*centrobank$CNY_156), color = 'purple3', shape=13, alpha=0.7, size = 4) + 
  geom_point(aes(y=100*centrobank$INR_356), color = 'orange', shape=14, alpha=0.7, size = 4) + 
  geom_smooth(aes(y=100*centrobank$JPY_392), color = 'red') +  
  geom_smooth(aes(y=centrobank$USD_840), color = 'blue') +  
  geom_smooth(aes(y=centrobank$EUR_978), color = 'green') +  
  geom_smooth(aes(y=10*centrobank$CNY_156), color = 'magenta') +  
  geom_smooth(aes(y=100*centrobank$INR_356), color = 'yellow') + 
  annotate(geom="text",x=as.Date(x1),y=y1,label=note1,fontface="bold",size = 8,color = "red") +
  annotate(geom="text",x=as.Date(x2),y=y2,label=note2,fontface="bold",size = 8,color = "blue") +
  annotate(geom="text",x=as.Date(x3),y=y3,label=note3,fontface="bold",size = 8,color = "green") +
  annotate(geom="text",x=as.Date(x4),y=y4,label=note4,fontface="bold",size = 8,color="magenta") +
  annotate(geom="text",x=as.Date(x5),y=y5,label=note5,fontface="bold",size = 8,color="yellow") +
  ylab('100 JRY, USD, EUR, 10 CNY, 100 INR') + 
  ggtitle('Bank of Russia, 2012-2016') + theme_bw() + 
  theme(axis.title.y = element_text(colour="grey20",size=16,angle=90,hjust=.5,vjust=.5,face="plain"))
```

```{r fig.width=14, fig.height=20, echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_4}
g11 <- grid.arrange(p22, p23, ncol=1)
ggsave('/Users/olgabelitskaya/projects/nd002/Data_Analyst_ND_Project4/figure-html/Multivariate_Plots_4-1.png', g11, width = 18, height = 24)
```

##### 5.1.2 A plot for exchange rates (USD, EUR) and gold price in 2015-2016.

```{r fig.width=8, fig.height=6, echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_5}
centrobank2016 = subset(centrobank, year == 2015 | year == 2016)
pl1 <- plot_ly(centrobank2016, x=EUR_978, y=USD_840, z=gold, color = gold, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "circle-open"))
pl1
```

##### 5.1.3 A plot for prices of precious metals (gold, silver) and dual currency basket in 2015-2016.

```{r fig.width=8, fig.height=6, echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots_6}
pl2 <- plot_ly(centrobank2016, x=gold, y=silver, z=dual_currency_basket, color = dual_currency_basket, text = paste(date), colors = 'Spectral', type="scatter3d", mode="markers", marker = list(size = 8, symbol = "diamond-open"))
pl2
```

## 5.2 Multivariate Analysis

##### It is easy to see that the prices of precious metals and currencies show almost the same trend concerning the national currency. Only silver prices were different from everyone else. For this metal price dynamics in most cases is decreasing in the 2012-2014 period.

##### These conclusions are confirmed by three-dimensional graphics. Adding the price of silver as a variable had led to the considerable spread of the data.

## 5.3 OPTIONAL: Building the Linear Model

##### We can construct a model of the dependence the price of gold on the price of the currency basket and the prices of other precious metals.

```{r echo=FALSE, message=FALSE, warning=FALSE, Building_Linear_Model}
m1 <- lm(gold ~ dual_currency_basket, data = centrobank)
m2 <- update(m1, ~ . + platinum)
m3 <- update(m2, ~ . + palladium)
m4 <- update(m3, ~ . + silver)
mtable(m1, m2, m3, m4)
```

##### All derived statistical coefficients unambiguously confirm the existence of relationships between these indicators and the fairly good quality of the constructed model.

# 6 Final Plots and Summary

### 6.1.1 Plot One

```{r echo=FALSE, Plot_One}
mcorr_centrobank <- cor(corr_centrobank)
corrplot.mixed(mcorr_centrobank, lower="number", upper="pie", order ="AOE", tl.col="darkblue", tl.cex=0.5)
```

### 6.1.2 Description One

##### The first final plot is a graphical table of correlation between variables. It emphasizes once again the strong relationship between almost all indicators.

### 6.2.1 Plot Two

```{r echo=FALSE, Plot_Two}

```

### 6.2.2 Description Two


### 6.3.1 Plot Three

```{r echo=FALSE, Plot_Three}

```

### 6.3.2 Description Three



# 7 Reflection

##### The centrobank data set contains information on almost 1,100 days of measuring the economic indicators. The data description can be found in the file with this database on the second page.

##### In general it's a very difficult sphere for prediction because of many external factors, so for more correct researching I think it needs to have about 5000-10000 rows of data and some additional factors (oil prices, for example).

##### For this project, I have set for myself the task of training rather than a researching. I have been studying and applying the programming language R for the first time so I had chosen the lightest model for investigating, where economic relations between the variables are obvious.

##### For these goals different plotting techniques had been used. R has a very wide range of instruments, I hope I was able to learn at least some of them.

##### In addition, I have been studying to apply this language in the R-Studio and the Jupyter Notebook. In some cases, I was unable to apply the same methodology. For example, I would like to know how to use the plotly package in the Jupyter Notebook, but it shows errors during installation. 

##### The broad field of research is ahead with the addition of more and more wide range of methods and indicators.
